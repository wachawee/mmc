
#include <stdlib.h>
#include <string.h>

#include <stdlib.h>
#include <string.h>

// include NESLIB header
#include "neslib.h"

// include CC65 NES Header (PPU)
#include <nes.h>

// link the pattern table into CHR ROM
//#link "smonster.s"

// BCD arithmetic support
#include "bcd.h"
//#link "bcd.c"

// VRAM update buffer
#include "vrambuf.h"
//#link "vrambuf.c"

#define NES_MAPPER 2
#define NES_CHR_BANK 0

const char TILESET[256] = {
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x8,0xF,0x7,0x5,0x3,0x2,0x2,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x7C,0xFF,0xFF,0xFF,0xFF,0x7E,0x3C,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x81,
0x0,0x0,0x88,0x18,0x78,0xB0,0x3,0x4,
0x0,0x8,0x10,0x60,0x0,0x0,0x0,0xF0,
0x0,0x0,0x0,0x1,0x0,0x0,0x2,0x1,
0x0,0x0,0x0,0x0,0x0,0xE,0x18,0x1,
0x12,0x12,0x31,0x35,0x74,0xEE,0xCE,0x83,
0x10,0x10,0x30,0xB0,0x70,0xE0,0xD0,0x9C,
0x88,0xC1,0x71,0x70,0x3,0x82,0x34,0x44,
0x42,0x35,0x5,0x4,0x88,0x79,0x2,0x2,
0xE,0x31,0x10,0xC8,0x0,0x0,0x10,0x28,
0x0,0x0,0x0,0xD0,0x18,0xFC,0xCC,0x24,
0x1,0x1,0x0,0x22,0x6,0x0,0x0,0x0,
0x1D,0x75,0x54,0x48,0x20,0x0,0x0,0x0,
0x0,0x80,0x6,0x3,0x9,0x36,0x73,0xC,
0x7,0x80,0x0,0x0,0x8,0x6,0x83,0x70,
0x70,0xFA,0xFB,0x4,0xF0,0x4,0x88,0x2,
0x1,0x0,0x0,0x2,0x0,0x4,0xB8,0x30,
0x0,0x80,0x0,0x60,0xC0,0x80,0x88,0x0,
0x80,0x70,0x0,0x0,0x20,0x47,0x41,0x77,
0x2,0x3,0x7,0x5,0xC,0xC,0xC,0x6,
0x2,0x3,0x7,0x5,0xC,0xC,0xC,0x6,
0x0,0x81,0x4F,0x6E,0x3C,0x10,0x0,0x0,
0xE,0x80,0x0,0x1,0x2,0x8,0x0,0x0,
0x0,0x9C,0x7,0x23,0x16,0x18,0xC,0x0,
0x3,0x0,0x0,0x20,0x11,0x18,0xC,0x0,
0x8,0x5,0x0,0x0,0x0,0x0,0x0,0x0,
0x21,0x2,0x80,0x80,0x0,0x0,0x0,0x0,
};
/*{pal:"nes",layout:"nes"}*/
const char PALETTE[32] = { 
  0x03,			// screen color

  0x11,0x30,0x27,0x0,	// background palette 0
  0x1c,0x20,0x2c,0x0,	// background palette 1
  0x00,0x10,0x20,0x0,	// background palette 2
  0x06,0x16,0x26,0x0,   // background palette 3

  0x16,0x35,0x24,0x0,	// sprite palette 0
  0x00,0x37,0x25,0x0,	// sprite palette 1
  0x0d,0x2d,0x3a,0x0,	// sprite palette 2
  0x0d,0x27,0x2a	// sprite palette 3
};

// setup PPU and tables
void setup_graphics() {
  // clear sprites
  oam_clear();
  // set palette colors
  pal_all(PALETTE);
}

void main(void)
{
  setup_graphics();
  // copy background tiles
  vram_adr(0xFF);
  vram_write(TILESET,256);
  
  // draw message  
 
  // enable rendering
  ppu_on_all();
  // infinite loop
  while(1) {
  }
}
